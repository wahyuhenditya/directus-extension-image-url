var t={props:{value:{type:String,default:null},dbSafe:{type:Boolean,default:!1},placeholder:{type:String,default:null}},data:function(){return{loading:!1,localValue:this.value,dialogShow:null,hasError:!1}},watch:{value:function(t,n){!n&&t&&(this.localValue=t,this.isUri(t)&&this.checkUrl(t)&&(this.hasError=null))}},methods:{handleInput:function(t){if(t){let n;const r=this;this.hasError=!1,this.localValue=t,this.loading=!0,clearTimeout(n),n=setTimeout((function(){r.loading=!1,r.processUrl(t)}),1e3)}else this.processUrl(t)},setDialogShow:function(){this.dialogShow=!0},unsetDialogShow:function(){this.dialogShow=null},isUri:function(t){try{new URL(t)}catch(t){return!1}return!0},checkUrl:function(t){return null!=t?.match(/\.(jpeg|jpg|gif|png)$/)},processUrl:function(t){return t?this.isUri(t)?this.checkUrl(t)?(this.hasError=null,this.$emit("input",t),!0):(this.hasError="Invalid URL extension",!1):(this.hasError="Invalid URL",!1):(this.hasError=!1,this.localValue="",this.$emit("input",null),!1)}}};function n(t,n,r,e,a,i,l,o,s,c){"boolean"!=typeof l&&(s=o,o=l,l=!1);const u="function"==typeof r?r.options:r;let d;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,a&&(u.functional=!0)),e&&(u._scopeId=e),i?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,s(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},u._ssrRegister=d):n&&(d=l?function(t){n.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){n.call(this,o(t))}),d)if(u.functional){const t=u.render;u.render=function(n,r){return d.call(r),t(n,r)}}else{const t=u.beforeCreate;u.beforeCreate=t?[].concat(t,d):[d]}return r}const r="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function e(t){return(t,n)=>function(t,n){const e=r?n.media||"default":t,l=i[e]||(i[e]={ids:new Set,styles:[]});if(!l.ids.has(t)){l.ids.add(t);let r=n.source;if(n.map&&(r+="\n/*# sourceURL="+n.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n.map))))+" */"),l.element||(l.element=document.createElement("style"),l.element.type="text/css",n.media&&l.element.setAttribute("media",n.media),void 0===a&&(a=document.head||document.getElementsByTagName("head")[0]),a.appendChild(l.element)),"styleSheet"in l.element)l.styles.push(r),l.element.styleSheet.cssText=l.styles.filter(Boolean).join("\n");else{const t=l.ids.size-1,n=document.createTextNode(r),e=l.element.childNodes;e[t]&&l.element.removeChild(e[t]),e.length?l.element.insertBefore(n,e[t]):l.element.appendChild(n)}}}(t,n)}let a;const i={};const l=t;var o=function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",[r("v-input",{class:t.hasError&&"error",attrs:{value:t.localValue,"db-safe":t.dbSafe,placeholder:t.placeholder},on:{input:t.handleInput},scopedSlots:t._u([{key:"append",fn:function(){return[null===t.hasError&&t.localValue?r("v-icon",{staticStyle:{color:"var(--green)"},attrs:{name:"launch"},on:{click:t.setDialogShow}}):t._e(),t._v(" "),t.hasError?r("v-icon",{staticStyle:{color:"var(--red)"},attrs:{name:"error"}}):t._e(),t._v(" "),t.loading?r("v-icon",{staticClass:"loader",attrs:{name:"sync"}}):t._e()]},proxy:!0}])}),t._v(" "),t.hasError?r("v-notice",{attrs:{type:"warning"}},[t._v("\n\t\t"+t._s(t.hasError)+"\n\t")]):t._e(),t._v(" "),r("v-dialog",{attrs:{active:null!==t.dialogShow},on:{toggle:t.unsetDialogShow,esc:t.unsetDialogShow}},[r("v-card",[r("v-card-title",[t._v("Preview")]),t._v(" "),r("v-card-text",[r("img",{staticClass:"preview-image",attrs:{src:t.localValue}})]),t._v(" "),r("v-card-actions",[r("v-button",{attrs:{secondary:""},on:{click:t.unsetDialogShow}},[t._v("\n\t\t\t\t\tClose\n\t\t\t\t")])],1)],1)],1)],1)};o._withStripped=!0;var s={id:"image-preview",name:"Image URL",description:"Validate & preview image from inputted Link",icon:"image_search",component:n({render:o,staticRenderFns:[]},(function(t){t&&t("data-v-1061a0d6_0",{source:"\n@keyframes spin-loader {\n100% {\r\n\t\ttransform: rotate(360deg);\n}\n}\n.v-card-actions, .v-card-title {\r\n\tjustify-content: center;\n}\n.preview-image {\r\n\tdisplay: block;\r\n\tmargin: auto;\r\n\tmax-width: 100%;\r\n    max-height: 66vh;\n}\n.loader {\r\n\tanimation: spin-loader 1s infinite;\r\n\tanimation-timing-function: linear;\n}\n.error > .input {\r\n\tborder-color: var(--red) !important;\n}\r\n",map:{version:3,sources:["G:\\htdocs\\directus-extension-image-url\\src\\interface.vue"],names:[],mappings:";AAyIA;AACA;EACA,yBAAA;AACA;AACA;AAEA;CACA,uBAAA;AACA;AACA;CACA,cAAA;CACA,YAAA;CACA,eAAA;IACA,gBAAA;AACA;AAEA;CACA,kCAAA;CACA,iCAAA;AACA;AAEA;CACA,mCAAA;AACA",file:"interface.vue",sourcesContent:['<template>\r\n\t<div>\r\n\t\t<v-input \r\n\t\t\t:value="localValue"\r\n\t\t\t:db-safe="dbSafe"\r\n\t\t\t:placeholder="placeholder"\r\n\t\t\t:class="hasError && \'error\'"\t\t\r\n\t\t\t@input="handleInput"\r\n\t\t>\r\n\t\t\t<template #append>\r\n\t\t\t\t<v-icon v-if="hasError === null && localValue" name="launch" @click="setDialogShow" style="color: var(--green)" />\r\n\t\t\t\t<v-icon v-if="hasError" name="error" style="color: var(--red)" />\r\n\t\t\t\t<v-icon v-if="loading" name="sync" class="loader" />\r\n\t\t\t</template>\r\n\t\t</v-input>\r\n\t\t<v-notice v-if="hasError" type="warning">\r\n\t\t\t{{ hasError }}\r\n\t\t</v-notice>\r\n\t\t<v-dialog\r\n\t\t\t:active="dialogShow !== null"\r\n\t\t\t@toggle="unsetDialogShow"\r\n\t\t\t@esc="unsetDialogShow"\r\n\t\t>\r\n\t\t\t<v-card>\r\n\t\t\t\t<v-card-title>Preview</v-card-title>\r\n\t\t\t\t<v-card-text>\r\n\t\t\t\t\t<img class="preview-image" :src="localValue" />\r\n\t\t\t\t</v-card-text>\r\n\t\t\t\t<v-card-actions>\r\n\t\t\t\t\t<v-button secondary @click="unsetDialogShow">\r\n\t\t\t\t\t\tClose\r\n\t\t\t\t\t</v-button>\r\n\t\t\t\t</v-card-actions>\r\n\t\t\t</v-card>\r\n\t\t</v-dialog>\r\n\t</div>\r\n</template>\r\n\r\n\r\n<script>\r\nexport default {\r\n\tprops: {\r\n\t\tvalue: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: null,\r\n\t\t},\r\n\t\tdbSafe: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false,\r\n\t\t},\r\n\t\tplaceholder: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: null,\r\n\t\t},\r\n\t},\r\n\tdata: function() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\tlocalValue: this.value,\r\n\t\t\tdialogShow: null,\r\n\t\t\thasError: false\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\tvalue: function(newVal, oldVal) {\r\n\t\t\tif (!oldVal && newVal) {\r\n\t\t\t\tthis.localValue = newVal;\r\n\r\n\t\t\t\tif(this.isUri(newVal) && this.checkUrl(newVal)) {\r\n\t\t\t\t\tthis.hasError = null\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\thandleInput: function(val) {\r\n\t\t\tif(val) {\r\n\t\t\t\tlet typing;\r\n\t\t\t\tconst self = this;\r\n\t\t\t\t\r\n\t\t\t\tthis.hasError = false;\r\n\t\t\t\tthis.localValue = val;\r\n\t\t\t\tthis.loading = true;\r\n\r\n\t\t\t\tclearTimeout(typing);\r\n\t\t\t\ttyping = setTimeout(function(){\r\n\t\t\t\t\tself.loading = false;\r\n\t\t\t\t\tself.processUrl(val);\r\n\t\t\t\t}, 1000)\r\n\t\t\t} else {\r\n\t\t\t\tthis.processUrl(val);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetDialogShow: function() {\r\n\t\t\tthis.dialogShow = true;\r\n\t\t},\r\n\t\tunsetDialogShow: function() {\r\n\t\t\tthis.dialogShow = null;\r\n\t\t},\r\n\t\tisUri: function(url) {\r\n\t\t\ttry {\r\n\t\t\t\tnew URL(url);\r\n\t\t\t} catch (error) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tcheckUrl: function(url) {\r\n\t\t\treturn url?.match(/\\.(jpeg|jpg|gif|png)$/) != null;\r\n\t\t},\r\n\t\tprocessUrl: function(url) {\r\n\t\t\tif(!url) {\r\n\t\t\t\tthis.hasError = false;\r\n\t\t\t\tthis.localValue = \'\';\r\n\t\t\t\tthis.$emit("input", null);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.isUri(url)) {\r\n\t\t\t\tthis.hasError = "Invalid URL";\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.checkUrl(url)) {\r\n\t\t\t\tthis.hasError = "Invalid URL extension";\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis.hasError = null;\r\n\t\t\tthis.$emit("input", url);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n};\r\n<\/script>\r\n\r\n<style>\r\n@keyframes spin-loader {\r\n\t100% {\r\n\t\ttransform: rotate(360deg);\r\n\t}\r\n}\r\n\r\n.v-card-actions, .v-card-title {\r\n\tjustify-content: center;\r\n}\r\n.preview-image {\r\n\tdisplay: block;\r\n\tmargin: auto;\r\n\tmax-width: 100%;\r\n    max-height: 66vh;\r\n}\r\n\r\n.loader {\r\n\tanimation: spin-loader 1s infinite;\r\n\tanimation-timing-function: linear;\r\n}\r\n\r\n.error > .input {\r\n\tborder-color: var(--red) !important;\r\n}\r\n</style>']},media:void 0})}),l,undefined,false,undefined,!1,e,void 0,void 0),types:["string"],options:[{field:"placeholder",name:"Placeholder",meta:{width:"full",interface:"text-input",schema:{default_value:"Enter image URL"}}}]};export default s;
